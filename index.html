<!DOCTYPE html>
<html lang="PT-BR">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="./tutorial/imagens/blockly_sql.png">
    <title>Blockly SQL</title>

    <!-- Estilização da página -->
    <link rel="stylesheet" media="screen and (min-width: 860px)" href="widescreen.css">
    <link rel="stylesheet" media="screen and (max-width: 860px)" href="smallscreen.css">

    <!-- Biblioteca Blockly -->
    <script src="https://unpkg.com/blockly/blockly.min.js"></script>

    <!-- Blocos Personalisados -->
    <script src="./Blocos/customBlocks.js"></script>

    <!-- Gerador MySQL -->
    <script src="https://unpkg.com/blockly/lua_compressed.js"></script>
    <script src="./Blocos/geradorMySQL.js"></script>

    <!-- Gerador Web SQL -->
    <script src="https://unpkg.com/blockly/javascript_compressed.js"></script>
    <script src="./Blocos/geradorWebSQL.js"></script>

    <!-- Boostrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css"
        integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">

    <!-- GOOGLE ADSENSE-->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2545476433082338"
     crossorigin="anonymous"></script>
</head>

<body>
    <header>
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <div class="container-fluid">
                <ul class="nav navbar-nav">
                    <span class="navbar-brand mb-0 h1" style="padding: 1vh;">
                        <a class="nav-link" href="index.html" style="color: aliceblue;" title="Página inicial">BlocklySQL</a>
                    </span>
                </ul>
                <ul class="navbar-nav d-flex align-items-center">
                    <li class="nav-item active text-center">
                        <a class="nav-link" href="./index.html">
                            <i class="bi bi-house text-danger"></i> <span class="labelShow" style="color: aliceblue;">INÍCIO</span>
                        </a>
                    </li>
                    &nbsp;&nbsp;
                    <li class="nav-item active text-center">
                        <a class="nav-link" href="./estudos/estudo.html">
                            <i class="bi bi-pen text-warning"></i> <span class="labelShow">EXERCÍCIOS</span>
                        </a>
                    </li>
                    &nbsp;&nbsp;
                    <li class="nav-item active text-center">
                        <a class="nav-link" href="./tutorial/tutorial.html">
                            <i class="bi bi-info-circle text-info"></i> <span class="labelShow">TUTORIAL</span>
                        </a>
                    </li>
                    &nbsp;&nbsp;
                </ul>
                <ul class="nav navbar-nav ">
                    <a class="blocklyLogo" href="https://developers.google.com/blockly" target="_blank"title="Blockly Site">
                        <img class="image-responsive" src="https://developers.google.com/blockly/images/logos/logo_built_on.png" width="60px">
                    </a>
                </ul>
            </div>
        </nav>
    </header>

    <h6 class="textoApresentativo">Entenda comandos básicos do SQL com blocos visuais.</h6>

    <div id="blocklyArea"></div>
    <div id="blocklyDiv" ></div>

    <div class="options">
        <span class="labelShow" style="color: aliceblue;">Linguagem:</span>
        <select id="linguagens" onchange="mirrorEvent();">
            <option value="MySQL">MySQL</option>
            <option value="WebSQL">WebSQL</option>
        </select>

        <button type="button" class="btn btn-sm" onclick="runCode()" title="Executar código WebSQL">
            <i class="bi bi-play text-success"></i> <span class="labelShow"><br>Executar</span>
        </button>
        <button type="button" class="btn btn-sm" onclick="clearWS()" title="Limpar workspace">
            <i class="bi bi-eraser text-danger"></i> <span class="labelShow"><br>Limpar</span>
        </button>
        <button type="button" class="btn btn-sm" onclick="copyCode()" title="Copiar para área de transferência">
            <i class="bi bi-clipboard text-info"></i> <span class="labelShow"><br>Copiar</span>
        </button>
        <button type="button" class="btn btn-sm" onclick="mudarTema()" title="Mudar tema">
            <i id='themeBtn' class="bi bi-moon"></i> <span class="labelShow"><br>Tema</span>
        </button>
        <button type="button" class="btn btn-sm" onclick="testDB()" title="Gera estrutura exemplo">
            <i class="bi bi-code-square"></i> <span class="labelShow"><br>Exemplo</span>
        </button>
        <button type="button" class="btn btn-sm" onclick="saveWS()" title="Salvar workspace">
            <i class="bi bi-save2"></i> <span class="labelShow"><br>Salvar</span> 
        </button>
        <button type="button" class="btn btn-sm" onclick="loadWS()" title="Carregar workspace">
            <i class="bi bi-download"></i> <span class="labelShow"><br>Carregar</span> 
        </button>
    </div>

    <pre id="Codigo" class="codigoLigthTheme" style="resize: none;" readonly></pre>

    <div id="divSelect">
        <h6 style="color: aliceblue;">
            <i class="bi bi-box-arrow-down-left text-info"></i>
            Apresentação do comando SELECT
            <i class="bi bi-box-arrow-down-right text-info"></i>
        </h6>
    </div>
    <div id="tabela">
        <div class="col table-responsive">
            <table id="tabelaSelect" class="table table-dark table-striped table-hover mx-auto w-auto"> </table>
        </div>
    </div>
    
    <!-- Alertar e Avisos-->
    <!-- Icones -->
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
        <symbol id="check-circle-fill" fill="currentColor" viewBox="0 0 16 16">
            <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
        </symbol>
        <symbol id="info-fill" fill="currentColor" viewBox="0 0 16 16">
            <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"/>
        </symbol>
        <symbol id="exclamation-triangle-fill" fill="currentColor" viewBox="0 0 16 16">
            <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
        </symbol>
    </svg>

    <!-- Alertas -->
    <div id="alerta1" style="display: none;">
        <div class="alert alert-warning d-flex align-items-center alert-dismissible fade show" role="alert">
            <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Warning:"><use xlink:href="#exclamation-triangle-fill"/></svg>
            <div id="alertmsg1"></div>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close" onclick="closeAlerts()"></button>
        </div>
    </div>
    
    <div id="alerta2" style="display: none;">
        <div class="alert alert-info d-flex align-items-center alert-dismissible fade show" role="alert">
            <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Info:"><use xlink:href="#info-fill"/></svg>
            <div id="alertmsg2"></div>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close" onclick="closeAlerts()"></button>
        </div>
    </div>
    
    <div id="alerta3" style="display: none;">
        <div class="alert alert-success d-flex align-items-center" role="alert">
            <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Success:"><use xlink:href="#check-circle-fill"/></svg>
            <div id="alertmsg3"></div>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close" onclick="closeAlerts()"></button>
        </div>
    </div>
</body>

<xml id="toolbox" style="display: none">
    <category name="Inicia SQL" colour="130">
        <label text="Inicia um novo banco de dados ou conecta a um já existente."></label>
        <block type="start_sql"></block>
    </category>
    <category name="Criar" colour="240">
        <label text="CREATE TABLE - Cria uma nova tabela no banco de dados."></label>
        <label text="Cria a estrutura base CREATE TABLE com variáveis"></label>
        <block type="create_table">
            <statement name="table_var">
                <block type="table_var">
                    <next>
                        <block type="table_var">
                            <next>
                                <block type="table_var">
                            </next>
                        </block>
                    </next>
                </block>
            </statement>
        </block>
        <label text="Estrutura CREATE TABLE."></label>
        <block type="create_table"></block>
    </category>
    <category name="Inserir" colour="285">
        <label text="INSERT INTO - Insere novo(s) dado(s) a uma tabela."></label>
        <block type="insert_table">
            <statement name="insert_var">
                    <block type="insert_start"></block>
            </statement>
        </block>
    </category>
    <category name="Alterar" colour="45">
        <label text="ALTER TABLE - Adiciona ou remove uma variável da tabela."></label>
        <label text="Cria a estrutura base ALTER TABLE."></label>
        <block type="alter_table"></block>
    </category>
    <category name="Atualizar" colour="30">
        <label text="UPDATE - Altera um dado já adicionado."></label>
        <label text="Cria a estrutura base UPDATE com dados."></label>
        <block type="update_table">
            <statement name="update_var">
                <block type="update_var">
                    <next>
                        <block type="update_var"></block>
                    </next>
                </block>
            </statement>
        </block>
        <label text="Estrutura UPDATE."></label>
        <block type="update_table"></block>
    </category>
    <category name="Selecionar" colour="165">
        <label text="SELECT - Pesquisa por dados na tabela."></label>
        <label text="Cria uma estrutura SELECT simples."></label>
        <block type="select2"></block>
        <label text="Cria uma estrutura SELECT com restrição de apresentação."></label>
        <block type="select4"></block>
        <label text="Cria uma estrutura SELECT com interação de tabelas."></label>
        <block type="select3"></block>
        <label text="Cria uma estrutura SELECT completa."></label>
        <block type="select"></block>
    </category>
    <category name="Deletar" colour="345">
        <label text="DROP TABLE - Deleta uma tabela do banco de dados."></label>
        <label text="Cria a estrutura base DROP TABLE."></label>
        <block type="drop_table"></block>
        <label text="DELETE FROM - Excluí um ou varios dados de uma tabela."></label>
        <label text="Cria a estrutura base DELETE FROM."></label>
        <block type="delete_from_table"></block>
    </category>
</xml>

<xml id="testDB" style="display: none">
    <block type="start_sql" x="20" y="20">
        <field name="db_name">db</field>
        <next>
            <block type='drop_table'>
                <field name="name_table">pessoa</field>
                <field name="option"> IF EXISTS</field>
                <next>
                    <block type="create_table">
                        <field name="option"> IF NOT EXISTS</field>
                        <field name="table_name">pessoa</field>
                        <statement name="table_var">
                            <block type="table_var">
                                <field name="var_name">id</field>
                                <field name="type">INTEGER</field>
                                <field name="opcao"> NOT NULL AUTO_INCREMENT</field>
                                <next>
                                    <block type="table_var">
                                        <field name="var_name">nome</field>
                                        <field name="opcao"> NOT NULL</field>
                                        <next>
                                            <block type="table_var">
                                                <field name="var_name">cpf</field>
                                                <field name="opcao"> UNIQUE</field>
                                                <next>
                                                    <block type="table_var">
                                                        <field name="var_name">idade</field>
                                                        <field name="type">INTEGER</field>
                                                        <next>
                                                            <block type="table_var">
                                                                <field name="var_name">telefone</field>
                                                                <next>
                                                                    <block type='table_var_pk'>
                                                                        <field name="var_name">id</field>
                                                                    </block>
                                                                </next>
                                                            </block>
                                                        </next>
                                                    </block>
                                                </next>
                                            </block>
                                        </next>
                                    </block>
                                </next>
                            </block>
                        </statement>
                        <next>
                            <block type="insert_table">
                                <field name="table_name">pessoa</field>
                                <statement name="insert_var">
                                    <block type="insert_start">
                                        <value name="insert_var">
                                            <block type="insert_var_default">
                                                <value name="insert_var">
                                                    <block type="insert_var">
                                                        <field name="var_input">Anderson Joaquim Lima</field>
                                                        <value name="insert_var">
                                                            <block type="insert_var">
                                                                <field name="var_input">109.419.057-80</field>
                                                                <value name="insert_var">
                                                                    <block type="insert_var">
                                                                        <field name="var_input">32</field>
                                                                        <value name="insert_var">
                                                                            <block type="insert_var">
                                                                                <field name="var_input">(63) 2924-7115</field>
                                                                            </block>
                                                                        </value>
                                                                    </block>
                                                                </value>
                                                            </block>
                                                        </value>
                                                    </block>
                                                </value>
                                            </block>
                                        </value>
                                    </block>
                                </statement>
                                <next>
                                    <block type="insert_table">
                                        <field name="table_name">pessoa</field>
                                        <statement name="insert_var">
                                            <block type="insert_start">
                                                <value name="insert_var">
                                                    <block type="insert_var_default">
                                                        <value name="insert_var">
                                                            <block type="insert_var">
                                                                <field name="var_input">Mariana Gabrielly Ribeiro</field>
                                                                <value name="insert_var">
                                                                    <block type="insert_var">
                                                                        <field name="var_input">746.328.138-85</field>
                                                                        <value name="insert_var">
                                                                            <block type="insert_var">
                                                                                <field name="var_input">27</field>
                                                                                <value name="insert_var">
                                                                                    <block type="insert_var">
                                                                                        <field name="var_input">(86) 3645-6679</field>
                                                                                    </block>
                                                                                </value>
                                                                            </block>
                                                                        </value>
                                                                    </block>
                                                                </value>
                                                            </block>
                                                        </value>
                                                    </block>
                                                </value>
                                            </block>
                                        </statement>
                                        <next>
                                            <block type="insert_table">
                                                <field name="table_name">pessoa</field>
                                                <statement name="insert_var">
                                                    <block type="insert_start">
                                                        <value name="insert_var">
                                                            <block type="insert_var_default">
                                                                <value name="insert_var">
                                                                    <block type="insert_var">
                                                                        <field name="var_input">Eduardo Manuel Barbosa</field>
                                                                        <value name="insert_var">
                                                                            <block type="insert_var">
                                                                                <field name="var_input">230.083.525-88</field>
                                                                                <value name="insert_var">
                                                                                    <block type="insert_var">
                                                                                        <field name="var_input">16</field>
                                                                                        <value name="insert_var">
                                                                                            <block type="insert_var">
                                                                                                <field name="var_input">(68) 3983-5955</field>
                                                                                            </block>
                                                                                        </value>
                                                                                    </block>
                                                                                </value>
                                                                            </block>
                                                                        </value>
                                                                    </block>
                                                                </value>
                                                            </block>
                                                        </value>
                                                    </block>
                                                </statement>
                                                <next>
                                                    <block type='drop_table'>
                                                        <field name="name_table">pedido</field>
                                                        <field name="option"> IF EXISTS</field>
                                                        <next>
                                                            <block type="create_table">
                                                                <field name="option"> IF NOT EXISTS</field>
                                                                <field name="table_name">pedido</field>
                                                                <statement name="table_var">
                                                                    <block type="table_var">
                                                                        <field name="var_name">id_pedido</field>
                                                                        <field name="type">INTEGER</field>
                                                                        <field name="opcao"> NOT NULL AUTO_INCREMENT</field>
                                                                        <next>
                                                                            <block type="table_var">
                                                                                <field name="var_name">id_comprador</field>
                                                                                <field name="type">INTEGER</field>
                                                                                <next>
                                                                                    <block type="table_var">
                                                                                        <field name="var_name">data_compra</field>
                                                                                        <field name="type">TIMESTAMP</field>
                                                                                        <next>
                                                                                            <block type='table_var_pk'>
                                                                                                <field name="var_name">id_pedido</field>
                                                                                            </block>
                                                                                        </next>
                                                                                    </block>
                                                                                </next>
                                                                            </block>
                                                                        </next>
                                                                    </block>
                                                                </statement>
                                                                <next>
                                                                    <block type="insert_table">
                                                                        <field name="table_name">pedido</field>
                                                                        <statement name="insert_var">
                                                                            <block type="insert_start">
                                                                                <value name="insert_var">
                                                                                    <block type="insert_var_default">
                                                                                        <value name="insert_var">
                                                                                            <block type="insert_var">
                                                                                                <field name="var_input">2</field>
                                                                                                <value name="insert_var">
                                                                                                    <block type="insert_var_default">
                                                                                                        <field name="var_input">CURRENT_TIMESTAMP</field>
                                                                                                    </block>
                                                                                                </value>
                                                                                            </block>
                                                                                        </value>
                                                                                    </block>
                                                                                </value>
                                                                            </block>
                                                                        </statement>
                                                                        <next>
                                                                            <block type="insert_table">
                                                                                <field name="table_name">pedido</field>
                                                                                <statement name="insert_var">
                                                                                    <block type="insert_start">
                                                                                        <value name="insert_var">
                                                                                            <block type="insert_var_default">
                                                                                                <value name="insert_var">
                                                                                                    <block type="insert_var">
                                                                                                        <field name="var_input">1</field>
                                                                                                        <value name="insert_var">
                                                                                                            <block type="insert_var_default">
                                                                                                                <field name="var_input">CURRENT_TIMESTAMP</field>
                                                                                                            </block>
                                                                                                        </value>
                                                                                                    </block>
                                                                                                </value>
                                                                                            </block>
                                                                                        </value>
                                                                                    </block>
                                                                                </statement>
                                                                                <next>
                                                                                    <block type="select">
                                                                                        <value name="vars">
                                                                                            <block type="select_var">
                                                                                                <field name="var_input">*</field>
                                                                                            </block>
                                                                                        </value>
                                                                                        <value name="from">
                                                                                            <block type="select_from">
                                                                                                <field name="table_name">pedido</field>
                                                                                            </block>
                                                                                        </value>
                                                                                        <value name="join">
                                                                                            <block type="select_join">
                                                                                                <field name="table_name">pessoa</field>
                                                                                                <field name="table_var">id</field>
                                                                                                <field name="table_join_var">id_comprador</field>
                                                                                            </block>
                                                                                        </value>
                                                                                        <value name="conditions">
                                                                                            <block type="select_where">
                                                                                                <field name="variavel">idade</field>
                                                                                                <field name="op">>=</field>
                                                                                                <field name="value">18</field>
                                                                                            </block>
                                                                                        </value>
                                                                                        <value name="orderby">
                                                                                            <block type="select_orderby">
                                                                                                <field name="variavel">nome</field>
                                                                                                <field name="op"> ASC</field>
                                                                                            </block>
                                                                                        </value>
                                                                                    </block>
                                                                                </next>
                                                                            </block>
                                                                        </next>
                                                                    </block>
                                                                </next>
                                                            </block>
                                                        </next>
                                                    </block>
                                                </next>
                                            </block>
                                        </next>
                                    </block>
                                </next>
                            </block>
                        </next>
                    </block>
                </next>
            </block>
        </next>
    </block>
</xml>

<!-- Back end -->
<script src="./index.js"></script>

</html>